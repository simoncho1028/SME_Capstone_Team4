# 🚗 아파트 주차장 EV 충전 시뮬레이션

4층 규모 아파트 주차장에서 일반 차량과 전기차의 주차, 충전, 출차를 실시간으로 모델링하는 Python 시뮬레이션 엔진입니다.

## 🎯 프로젝트 개요

본 시뮬레이션은 실제 아파트 주차장 환경을 정밀하게 모델링하여 전기차 충전소 최적 배치와 주차장 운영 효율성을 분석합니다.

### ✨ 주요 특징

- **4층 통합 주차장**: GF(지상), B1F, B2F, B3F 총 4개 층
- **실시간 차량 흐름**: 시간대별 차량 도착 패턴 기반 시뮬레이션  
- **스마트 충전 시스템**: 전기차 배터리 상태에 따른 자동 충전
- **차량 순환 시스템**: 출차 후 재입차가 가능한 현실적 모델링
- **고급 분석 기능**: 통계, 시각화, 애니메이션 생성

## 🏗️ 시뮬레이션 환경

### 주차장 구조
- **총 4개 층**: 지상 1층 + 지하 3개 층
- **총 주차면**: 686면 (일반 주차면 650면 + 충전소 36개)
- **주차장 크기**: 각 층 다양한 레이아웃으로 구성

### 차량 구성
- **일반 차량**: 830대
- **전기차**: 36대
- **총 차량**: 866대

### 운영 방식
- **입차 패턴**: 시간대별 확률 분포 기반 (24시간 주기)
- **주차 시간**: 정규분포 (평균 12.25시간, 범위 0.5~24시간)
- **충전 시스템**: 배터리 부족 시 자동 충전 (5분당 1% 충전)

## 🚀 빠른 시작

### 설치

```bash
# 저장소 클론
git clone [repository-url]
cd SME_Capstone_Team4

# 의존성 설치
pip install -r requirements.txt
```

### 기본 실행

```bash
# 24시간 시뮬레이션 실행
python main.py

# 시각화와 함께 실행
python main.py --visualize --animation

# 48시간 시뮬레이션
python main.py --time 172800

# 레이아웃 시각화
python main.py --visualize-layout
```

## 📊 실행 결과

시뮬레이션 실행 후 다음과 같은 결과물이 생성됩니다:

### 📁 결과 디렉토리 구조
```
../results_sim_YYYYMMDD_HHMMSS/
├── simulation_log.csv              # 전체 이벤트 로그
├── charge_log.csv                  # 충전 관련 로그  
├── simulation_summary_YYYYMMDD_HHMMSS.txt  # 결과 요약
├── arrivals_by_hour.png           # 운영 현황 분석 차트
├── charging_patterns.png          # 충전 패턴 분석
├── final_parking_state.png        # 최종 주차장 상태
├── parking_animation_YYYYMMDD_HHMMSS.mp4   # 상태 변화 애니메이션
├── layout_GF.png                  # 각 층별 레이아웃
├── layout_B1F.png
├── layout_B2F.png
└── layout_B3F.png
```

### 📈 분석 리포트

시뮬레이션 완료 후 `simulation_summary.txt`에서 다음 정보를 확인할 수 있습니다:

```
==== 시뮬레이션 결과 ====
총 진행 시간: 1일 0시간 0분 0초

==== 주차장 세팅 ====
전체 주차면: 650면 (일반 주차면)
전체 충전소: 36개

=== 주차장 상태 (현재) ===
(1일 0시간 0분 0초) 동안 진행 후 현재 상황
총 주차된 차량: 574대
사용 가능한 주차면: 85면
사용 가능한 충전소: 27개

=== 통계 ===
총 입차 시도: 1617회
성공한 주차: 1617회
총 충전 시도: 47회
출차: 1043회

==== 최적화/운영 지표 ====
충전소 설치+유지 총비용: 54,000,000 원
충전소 공실률: 25.51%
충전 실패율: 0.00%
주차 실패율: 0.00%
```

## ⚙️ 상세 설정

### 주요 커맨드라인 옵션

```bash
# 시뮬레이션 기본 설정
--time 86400              # 시뮬레이션 시간 (초, 기본값: 24시간)
--seed 42                 # 난수 시드 (재현 가능한 결과)

# 차량 설정  
--normal 830              # 일반 차량 수
--ev 36                   # 전기차 수
--ev-chargers 36          # 충전소 수

# 출력 설정
--no-save-csv            # CSV 저장 비활성화
--output-prefix results  # 결과 디렉토리 접두사

# 시각화 설정
--visualize              # 최종 상태 시각화
--visualize-layout       # 주차장 레이아웃 시각화  
--animation              # 상태 변화 애니메이션 생성
--fps 10                 # 애니메이션 프레임 속도
--dpi 100                # 이미지 해상도

# 최적화 설정
--optimize               # 충전소 배치 최적화 수행
--min-chargers 4         # 최소 충전소 수
--max-chargers 12        # 최대 충전소 수
```

### 실행 예시

```bash
# 기본 24시간 시뮬레이션
python main.py

# 일주일 시뮬레이션 with 시각화
python main.py --time 604800 --visualize --animation

# 충전소 최적화 분석
python main.py --optimize --min-chargers 20 --max-chargers 50

# 고해상도 애니메이션 생성
python main.py --animation --fps 15 --dpi 200

# 다양한 시나리오 테스트
python main.py --normal 1000 --ev 50 --ev-chargers 50 --time 172800
```

## 🧠 시뮬레이션 로직

### 1. 차량 입차 시스템
- **시간대별 패턴**: 실제 아파트 주차장 데이터 기반 24시간 입차 분포
- **확률적 도착**: 각 시간대마다 다른 입차 확률 적용
- **일일 계획**: 매일 0시마다 새로운 입차 계획 수립

### 2. 주차 시간 모델링
- **정규분포 샘플링**: 평균 12.25시간, 표준편차 3.92시간
- **범위 제한**: 최소 30분 ~ 최대 24시간
- **현실적 패턴**: 실제 주차 행태 반영

### 3. 전기차 충전 시스템
- **자동 충전 감지**: 배터리 50% 이하 시 충전소 우선 탐색
- **실시간 충전**: 5분당 1% 속도로 배터리 충전
- **충전 완료**: 100% 충전 시 자동 종료

### 4. 차량 순환 메커니즘
- **출차 후 재활용**: 출차 차량이 대기 풀로 복귀
- **지속적 운영**: 시뮬레이션 기간 내내 새로운 입차 발생
- **현실적 모델링**: 실제 아파트 거주민 패턴 반영

## 📁 프로젝트 구조

```
SME_Capstone_Team4/
├── main.py                          # 🚀 메인 실행 파일
├── parking_animation.py             # 🎬 애니메이션 생성 도구
├── parking_layout_visualizer.py     # 🗺️ 레이아웃 시각화
├── requirements.txt                 # 📦 의존성 목록
├── data/
│   ├── vehicles.json               # 🚗 차량 데이터
│   └── parking_maps/               # 🗺️ 주차장 맵 파일
├── src/
│   ├── config.py                   # ⚙️ 설정 상수
│   ├── models/                     # 🏗️ 시뮬레이션 모델
│   │   ├── vehicle.py              # 🚗 차량 모델
│   │   ├── parking_manager.py      # 🅿️ 주차장 관리자
│   │   └── vehicle_manager.py      # 🚗 차량 관리자
│   ├── simulation/                 # 🎯 시뮬레이션 엔진
│   │   └── parking_simulation.py   # 🎯 메인 시뮬레이션
│   └── utils/                      # 🛠️ 유틸리티
│       ├── helpers.py              # 🔧 헬퍼 함수
│       ├── logger.py               # 📊 로깅 시스템
│       ├── visualizer.py           # 📈 시각화 도구
│       └── parking_map_loader.py   # 🗺️ 맵 로더
└── README.md                       # 📖 이 문서
```

## 🎨 시각화 기능

### 1. 실시간 상태 이미지
- 각 시점별 주차장 상태 스냅샷
- 차량 위치, 충전 상태 표시
- 층별 분리 시각화

### 2. 4D 애니메이션
- 시간에 따른 주차장 상태 변화
- 차량 이동, 주차, 충전 과정 시각화
- MP4 비디오 형식 저장

### 3. 분석 차트
- **운영 현황 분석**: 시간대별 도착 패턴, 충전소 이용률, 주차장 점유율
- **충전 패턴 분석**: 전기차별 배터리 변화 추이
- **층별 이용 현황**: 각 층별 점유율 분석

## 🔧 고급 기능

### 최적화 모드
```bash
python main.py --optimize --min-chargers 20 --max-chargers 50
```
- 충전소 수량에 따른 비용-효율성 분석
- 최적 충전소 배치 위치 탐색
- ROI(투자수익률) 계산

### 배치 실험
```bash
python main.py --visualize-layout
```
- 다양한 충전소 배치 시나리오 시각화
- 인접 충전소 배치 최적화
- 레이아웃별 효율성 분석

## 📈 성능 지표

### 운영 효율성
- **주차 성공률**: 입차 시도 대비 성공 비율
- **충전소 가동률**: 시간당 충전소 이용률
- **공간 활용률**: 전체 주차면 대비 점유율

### 경제성 분석
- **설치 비용**: 충전소 1대당 80만원 기준
- **유지 비용**: 연간 10만원/대 기준  
- **운영 수익**: 충전 1회당 5,000원 기준
- **ROI 계산**: 투자 회수 기간 분석

### 사용자 만족도
- **대기 시간**: 충전소 대기 시간 분석
- **접근성**: 주차면-충전소 간 거리 분석
- **편의성**: 충전 완료율, 실패율 추적

## 🔬 연구 활용

### 학술 연구
- 전기차 충전 인프라 최적화 연구
- 주차장 운영 효율성 분석
- 스마트 시티 교통 모델링

### 실무 적용
- 아파트 충전소 설치 계획 수립
- 주차장 리모델링 의사결정 지원
- 전기차 보급 정책 효과 분석

## 🛠️ 기술 스택

- **Python 3.8+**: 메인 개발 언어
- **SimPy**: 이산 사건 시뮬레이션 엔진
- **Pandas**: 데이터 처리 및 분석
- **Matplotlib**: 시각화 및 차트 생성
- **NumPy**: 수치 계산 및 통계 분석
- **FFmpeg**: 애니메이션 비디오 인코딩

## 🎯 향후 계획

### v2.0 계획
- [ ] 머신러닝 기반 수요 예측
- [ ] 실시간 최적화 알고리즘
- [ ] 3D 시각화 지원
- [ ] 웹 기반 대시보드

### v2.1 계획  
- [ ] 다중 시나리오 병렬 실행
- [ ] 클라우드 기반 대규모 시뮬레이션
- [ ] API 서버 제공
- [ ] 실시간 모니터링 시스템

## 🤝 기여하기

1. 이 저장소를 Fork 합니다
2. 새로운 기능 브랜치를 생성합니다 (`git checkout -b feature/amazing-feature`)
3. 변경사항을 커밋합니다 (`git commit -m 'Add amazing feature'`)
4. 브랜치에 Push 합니다 (`git push origin feature/amazing-feature`)
5. Pull Request를 생성합니다

## 📝 라이선스

이 프로젝트는 MIT 라이선스 하에 배포됩니다. 자세한 내용은 `LICENSE` 파일을 참조하세요.

## 📞 문의

프로젝트에 대한 질문이나 제안사항이 있으시면 이슈를 생성해 주세요.

---

**🎯 SME Capstone Team 4 - 스마트 주차장 최적화 프로젝트**